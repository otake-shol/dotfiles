# Slack Workflow Builder × Jira 連携ガイド

SlackのWorkflow Builderを使って、フォーム入力からJiraチケットを自動作成する手順です。

---

## 前提条件

- Slack Enterprise Grid
- Jira Cloud
- Slack に Jira Cloud アプリがインストール済み

---

## 完成イメージ

```
あなた: /jira-create
     ↓
┌──────────────────────────┐
│ 📝 Jiraチケット作成        │
│                          │
│ 案件名: [___________]    │
│ 概要:   [___________]    │
│ 優先度: [高 ▼]           │
│                          │
│        [送信]            │
└──────────────────────────┘
     ↓
Bot: ✅ Jiraチケットを作成しました
     📋 PROJ-123: ログイン機能の修正
     🔗 https://xxx.atlassian.net/browse/PROJ-123
```

---

## 作成手順

### Step 1：ワークフロービルダーを開く

1. Slackの左サイドバー「その他」→「自動化」をクリック
2. 「ワークフロービルダー」を選択
3. 「新しいワークフロー」をクリック
4. ワークフロー名を入力（例：`Jiraチケット作成`）

---

### Step 2：トリガーを設定

ワークフローの起動方法を選択します。

**オプションA：スラッシュコマンド（推奨）**
- 「リンクを使用してスタート」を選択
- コマンド名を設定（例：`/jira-create`）

**オプションB：ショートカット**
- 「ショートカットから」を選択
- メッセージメニューやチャンネルから起動可能

---

### Step 3：フォームを追加

1. 「ステップを追加」→「フォームを送信」を選択
2. フォームのタイトルを入力（例：`Jiraチケット作成`）
3. 以下の入力項目を追加：

| 項目名 | 入力タイプ | 必須 | 備考 |
|--------|-----------|------|------|
| 案件名 | 短いテキスト | ✅ | Jiraのタイトルになる |
| 概要 | 長いテキスト | ✅ | Jiraの説明文になる |
| 優先度 | リストから選択 | ✅ | 選択肢：高、中、低 |
| 担当者 | ユーザーを選択 | - | 任意 |

4. 「保存」をクリック

---

### Step 4：Jira連携を追加

1. 「ステップを追加」→「Jira」→「課題を作成」を選択
2. Jiraアカウントを接続（初回のみ）
3. 以下を設定：

| 設定項目 | 値 |
|----------|-----|
| サイト | あなたのJiraサイト（xxx.atlassian.net） |
| プロジェクト | 対象プロジェクトを選択 |
| 課題タイプ | Task / Story / Bug など |
| 概要（タイトル） | `{{フォーム回答.案件名}}` を挿入 |
| 説明 | `{{フォーム回答.概要}}` を挿入 |
| 優先度 | `{{フォーム回答.優先度}}` を挿入（マッピング必要な場合あり） |

4. 「保存」をクリック

---

### Step 5：完了メッセージを追加

1. 「ステップを追加」→「メッセージを送信」を選択
2. 送信先：「ワークフローを開始した人へDM」または「チャンネル」
3. メッセージ内容：

```
✅ Jiraチケットを作成しました

📋 *{{Jira.課題キー}}*: {{フォーム回答.案件名}}
🔗 {{Jira.課題URL}}

優先度: {{フォーム回答.優先度}}
```

※ 変数は「変数を挿入」ボタンから選択

4. 「保存」をクリック

---

### Step 6：公開

1. 右上の「公開する」をクリック
2. 使用するチャンネル/ユーザーを選択
3. 「公開」を確定

---

## 動作確認

1. Slackで `/jira-create` を入力（またはショートカットを起動）
2. フォームに入力して送信
3. Jiraチケットが作成され、リンクが返ってくることを確認
4. Jira側でチケットが正しく作成されているか確認

---

## トラブルシューティング

### Jira連携ステップが表示されない
- Slack に Jira Cloud アプリがインストールされているか確認
- Slackアプリ管理から「Jira Cloud」を検索してインストール

### 優先度のマッピングがうまくいかない
- Slackフォームの選択肢とJiraの優先度名を一致させる
- または、Jira側の優先度IDを直接指定

### 課題URLが取得できない
- Jiraコネクタのバージョンを確認
- 別の方法：課題キーから `https://xxx.atlassian.net/browse/{{課題キー}}` で構築

---

## 拡張アイデア

### Confluence連携を追加
1. 同じワークフローに「Confluence - ページを作成」ステップを追加
2. フォーム入力を使ってテンプレートページを複製・記入

### 要否判定の自動化
1. フォームに追加質問を設ける（例：「外部API連携あり？」Yes/No）
2. 条件分岐で異なるラベルやコンポーネントをJiraに設定

### 承認フローの追加
1. 「承認をリクエスト」ステップを追加
2. 上長が承認後にJiraチケット作成

---

## 参考リンク

- [Slack Workflow Builder 公式ドキュメント](https://slack.com/help/articles/360035692513)
- [Jira Cloud for Slack](https://www.atlassian.com/software/jira/guides/expand-jira/jira-slack-integration)
- [Slack + Jira 連携ガイド](https://support.atlassian.com/jira-cloud-administration/docs/integrate-with-slack/)
