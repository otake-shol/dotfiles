---
description: Markdownスライドを生成（クイック/インタラクティブ）
allowed-tools: Read, Write, Glob, Bash(marp *), Bash(mkdir *), Bash(open *)
---

# /slides - AIスライド生成

Marp CLIを使ってMarkdownからスライド（PDF/HTML/PPTX）を生成する。

## モード判定

ユーザー入力から自動判定：

- **クイックモード**: ファイルパス、URL、または変換対象テキストが含まれている場合
- **インタラクティブモード**: テーマ・トピックのみの場合（対話で構成を練る）

## クイックモード

1. 入力テキスト/ファイルを分析
2. Marp形式のMarkdownに変換
3. 出力先をユーザーに確認
4. 3形式で出力

## インタラクティブモード

1問ずつ順番に聞く（まとめて聞かない）：

1. **テンプレート選択** - 以下から選択（該当しなければ「フリー」）
   - チーム計画（半期）
   - LT（5分 / 10分）
   - フリー（テンプレートなし）
2. **対象者は？** - 誰に向けたスライドか
3. テンプレート別の追加質問（後述）
4. **特に伝えたいことは？** - キーメッセージの特定

回答を元に構成案を提示 → 承認後に生成。

### テンプレート: チーム計画（半期）

ブロック選択式。タイトルスライド(lead)は自動生成し、以下から必要なブロックを選んでもらう：

| ブロック | 説明 | 推奨クラス |
|---------|------|-----------|
| ビジョン・目標 | 半期の方向性 | lead |
| 振り返り・KPI | 前期の実績と数値 | columns |
| 重点テーマ | 今期の注力領域 | 通常 |
| ロードマップ | 四半期別タイムライン | columns |
| 体制・リソース | チーム構成と役割 | columns |
| リスク・課題 | 想定リスクと対策 | 通常 |
| マイルストーン | 主要マイルストーン一覧 | 通常 |
| OKR/戦略 | Objectives & Key Results | 通常 |

追加質問: **どのブロックを含めますか？**（複数選択）

### テンプレート: LT

時間に応じて枚数を自動計算：
- **5分** → 5-7枚
- **10分** → 10-12枚

固定構成:
1. タイトル（lead）
2. 自己紹介（1枚）
3. 課題提起（1枚）
4. 本題（5分: 2-3枚 / 10分: 5-7枚）
5. まとめ（1枚）
6. CTA・質疑（invert）

追加質問: **発表時間は？**（5分 / 10分）

## Marpフロントマター

生成するMarkdownには必ず以下を含める：

```markdown
---
marp: true
paginate: true
size: 16:9
theme: catppuccin-latte
---
```

## スライド構成ガイドライン

- 1スライド = 1メッセージ
- 箇条書きは最大5項目
- コードブロックはフォントサイズに注意（長すぎるコードは分割）
- セクション区切りには見出しスライドを使う
- スライドタイプに応じてクラスを使い分ける（lead, invert, quote, columns）
- `---` でスライドを区切る

## カスタムテーマ

Catppuccin Latteテーマを使う場合：

```bash
marp --no-stdin slide.md -o slide.pdf --theme ~/.claude/commands/slides-theme.css
```

テーマを使うかどうかはユーザーに確認する。

## 出力

出力先ディレクトリをユーザーに確認した上で、3形式を同時生成：

```bash
marp --no-stdin slide.md -o slide.pdf
marp --no-stdin slide.md -o slide.html
marp --no-stdin slide.md -o slide.pptx
```

注意: `--no-stdin` は必須。省略するとstdin待ちでハングする。

カスタムテーマ使用時は各コマンドに `--theme ~/.claude/commands/slides-theme.css` を追加。

生成後、`open slide.pdf` でプレビューを開く。

## デザインリファレンス

### スライドクラス

| クラス | 用途 | 使い方 |
|--------|------|--------|
| `lead` | タイトル・セクション区切り | `<!-- _class: lead -->` |
| `invert` | キーメッセージ・強調 | `<!-- _class: invert -->` |
| `quote` | 引用・名言 | `<!-- _class: quote -->` |
| `columns` | 2カラム比較・並列情報 | `<!-- _class: columns -->` |

### 背景画像

```markdown
![bg](url)              <!-- 全面背景 -->
![bg left](url)         <!-- 左半分に画像、右にテキスト -->
![bg right](url)        <!-- 右半分に画像、左にテキスト -->
![bg contain](url)      <!-- アスペクト比維持 -->
![bg 80%](url)          <!-- サイズ指定 -->
```

### ディレクティブ

```markdown
<!-- _class: lead -->           <!-- このスライドのみクラス適用 -->
<!-- _backgroundColor: #000 --> <!-- このスライドのみ背景色 -->
<!-- _color: #fff -->           <!-- このスライドのみ文字色 -->
```

### フィットヘッダー

```markdown
# <!-- fit --> 長いタイトルを自動縮小
```

### デザイン原則

- **視覚階層**: h1=青(accent), h2=紫(accent2), h3=シアン(cyan)
- **強調**: `**太字**`=黄色, `<mark>ハイライト</mark>`=黄色背景
- **余白**: 詰め込みすぎない。1スライド1メッセージを徹底
